<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Song Generator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body> 
    <div class="container">
        <h1>Custom Song Generator</h1>
        <form id="songForm">
            <label for="name">Your Name:</label>
            <input type="text" id="name" name="name" required>
            
            <label for="occasion">Occasion (e.g. birthday, anniversary):</label>
            <input type="text" id="occasion" name="occasion" required>
            
            <label for="relationship">Who is this for (e.g. wife, mom, friend):</label>
            <input type="text" id="relationship" name="relationship" required>

            <label for="theme">Song Theme (e.g. romantic, heartfelt, funny):</label>
            <input type="text" id="theme" name="theme" required>

            <label for="language">Language:</label>
            <select id="language" name="language" required>
                <option value="en">English</option>
                <option value="es">Spanish</option>
                <option value="fr">French</option>
                <option value="hi">Hindi</option>
            </select>

            <button type="submit">Generate Song</button>
        </form>

        <!-- Section to display the lyrics -->
        <div id="lyricsSection" style="display: none;">
            <h2>Generated Song Lyrics</h2>
            <p id="lyrics"></p>

            <!-- Download lyrics button -->
            <form action="/download_lyrics" method="POST">
                <input type="hidden" name="lyrics" id="hiddenLyrics">
                <button type="submit">Download Lyrics</button>
            </form>
        </div>

        <!-- Section for animations -->
        <div id="emojiSection" class="emoji-container"></div>
    </div>

    <script>
        const form = document.getElementById('songForm');
        const lyricsSection = document.getElementById('lyricsSection');
        const lyricsParagraph = document.getElementById('lyrics');
        const hiddenLyrics = document.getElementById('hiddenLyrics');
        const emojiSection = document.getElementById('emojiSection');

        form.onsubmit = async (e) => {
            e.preventDefault();
            const formData = new FormData(form);
            const response = await fetch('/generate', {
                method: 'POST',
                body: formData
            });
            const data = await response.json();

            // Display the lyrics
            lyricsParagraph.textContent = data.lyrics;
            hiddenLyrics.value = data.lyrics;
            lyricsSection.style.display = 'block';

            // Trigger emoji animation based on theme
            const theme = formData.get('theme').toLowerCase();
            triggerEmojiAnimation(theme);
        };

        function triggerEmojiAnimation(theme) {
            let emoji;
            let color;

            if (theme === 'romantic') {
                emoji = '‚ù§Ô∏è';
                color = 'lightpink';
            } else if (theme === 'funny') {
                emoji = 'üòÇ';
                color = 'lightyellow';
            } else if (theme === 'heartfelt') {
                emoji = 'üíñ';
                color = 'lightcoral';
            } else {
                emoji = 'üéµ';  // default music note
                color = 'lightblue';
            }

            document.body.style.backgroundColor = color;

            // Clear any existing emojis
            emojiSection.innerHTML = '';

            // Create emoji flying effect
            for (let i = 0; i < 20; i++) {
                const emojiElement = document.createElement('div');
                emojiElement.textContent = emoji;
                emojiElement.classList.add('flying-emoji');
                emojiElement.style.left = `${Math.random() * 100}%`;
                emojiElement.style.animationDelay = `${Math.random() * 2}s`;
                emojiSection.appendChild(emojiElement);
            }
        }
    </script>
</body>
</html>
